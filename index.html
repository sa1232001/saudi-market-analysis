<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“Š Ù…Ù†ØµØ© Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0B1426 0%, #1E293B 25%, #334155 50%, #1E293B 75%, #0B1426 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(34, 197, 94, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .header {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(16px);
            padding: 1.2rem 2rem;
            border-bottom: 1px solid rgba(34, 197, 94, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .logo {
            font-size: 1.6rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #22C55E, #16A34A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-bar {
            display: flex;
            gap: 2rem;
            font-size: 0.9rem;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(34, 197, 94, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22C55E;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px #22C55E;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        .main-container {
            display: grid;
            grid-template-columns: 320px 1fr 340px;
            gap: 1.5rem;
            padding: 1.5rem;
            height: calc(100vh - 100px);
        }

        .calculator-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .calculator-content {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(34, 197, 94, 0.3);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .calculator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .calculator-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #22C55E;
        }

        .close-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: #EF4444;
            border-radius: 10px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .calc-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .calc-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .calc-label {
            font-weight: 600;
            color: #22C55E;
        }

        .calc-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 0.8rem;
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .calc-input:focus {
            outline: none;
            border-color: #22C55E;
            box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);
        }

        .calc-button {
            background: linear-gradient(135deg, #22C55E, #16A34A);
            border: none;
            border-radius: 10px;
            padding: 1rem;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .calc-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);
        }

        .calc-results {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        .calc-result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .calc-result-item:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 1.1rem;
            color: #22C55E;
        }

        .chart-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .chart-type-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .chart-type-btn.active {
            background: rgba(34, 197, 94, 0.2);
            border-color: #22C55E;
            color: #22C55E;
        }

        .chart-type-btn:hover {
            background: rgba(34, 197, 94, 0.15);
        }

        .profit-calculator-btn {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background: linear-gradient(135deg, #22C55E, #16A34A);
            border: none;
            border-radius: 50px;
            padding: 1rem 1.5rem;
            color: white;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);
            transition: all 0.3s ease;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: float 3s ease-in-out infinite;
        }

        .profit-calculator-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(34, 197, 94, 0.4);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        .history-btn {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.4);
            color: #3B82F6;
            border-radius: 10px;
            padding: 0.5rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
            width: 100%;
        }

        .history-btn:hover {
            background: rgba(59, 130, 246, 0.3);
        }

        @media (max-width: 768px) {
            .profit-calculator-btn {
                bottom: 60px;
                left: 10px;
                padding: 0.8rem 1.2rem;
                font-size: 0.9rem;
            }

            .calculator-content {
                margin: 1rem;
                padding: 1.5rem;
            }

            .chart-type-selector {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .chart-type-btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .sidebar, .market-info, .chart-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .sidebar::before, .market-info::before, .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(34, 197, 94, 0.5), transparent);
        }

        .main-chart-area {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .market-info {
            overflow-y: auto;
        }

        .indices-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .index-card {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15) 0%, rgba(59, 130, 246, 0.1) 100%);
            border-radius: 16px;
            padding: 1.2rem;
            border: 1px solid rgba(34, 197, 94, 0.3);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .index-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .index-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(34, 197, 94, 0.3);
            border-color: #22C55E;
        }

        .index-card:hover::before {
            left: 100%;
        }

        .index-name {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .index-value {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.4rem;
            color: #22C55E;
        }

        .index-change {
            font-size: 0.85rem;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            display: inline-block;
            font-weight: 600;
        }

        .positive {
            background: rgba(34, 197, 94, 0.2);
            color: #22C55E;
            border: 1px solid rgba(34, 197, 94, 0.4);
        }

        .negative {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
            border: 1px solid rgba(239, 68, 68, 0.4);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #22C55E;
            position: relative;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, #22C55E, transparent);
            border-radius: 1px;
        }

        .stock-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.8rem;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stock-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: #22C55E;
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .stock-item:hover {
            background: rgba(34, 197, 94, 0.1);
            transform: translateX(-8px);
            border-color: rgba(34, 197, 94, 0.4);
        }

        .stock-item:hover::before {
            transform: scaleY(1);
        }

        .stock-info {
            display: flex;
            flex-direction: column;
        }

        .stock-name {
            font-weight: 700;
            margin-bottom: 0.3rem;
            color: #ffffff;
            font-size: 0.95rem;
        }

        .stock-sector {
            font-size: 0.8rem;
            opacity: 0.8;
            padding: 0.2rem 0.6rem;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            display: inline-block;
            width: fit-content;
        }

        .stock-price {
            text-align: left;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }

        .price {
            font-weight: 700;
            margin-bottom: 0.3rem;
            font-size: 1rem;
            color: #22C55E;
        }

        .chart-controls {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: white;
            padding: 0.7rem 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9rem;
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .control-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(34, 197, 94, 0.2), transparent);
            transition: left 0.3s;
        }

        .control-btn:hover, .control-btn.active {
            background: rgba(34, 197, 94, 0.2);
            border-color: #22C55E;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);
        }

        .control-btn:hover::before {
            left: 100%;
        }

        .news-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.2rem;
            border-left: 4px solid #22C55E;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .news-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #22C55E, #16A34A);
        }

        .news-item:hover {
            background: rgba(34, 197, 94, 0.1);
            transform: translateX(-8px);
            box-shadow: 0 8px 30px rgba(34, 197, 94, 0.2);
        }

        .news-title {
            font-weight: 700;
            margin-bottom: 0.8rem;
            color: #22C55E;
            font-size: 1rem;
            line-height: 1.4;
        }

        .news-summary {
            font-size: 0.9rem;
            opacity: 0.9;
            line-height: 1.6;
            margin-bottom: 0.8rem;
        }

        .news-time {
            font-size: 0.8rem;
            opacity: 0.7;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .ticker-tape {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 0.8rem;
            white-space: nowrap;
            overflow: hidden;
            border-top: 2px solid #22C55E;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 100;
            font-weight: 600;
        }

        .ticker-content {
            display: inline-block;
            animation: scroll-left 40s linear infinite;
            color: #22C55E;
        }

        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(34, 197, 94, 0.3);
            border-top: 4px solid #22C55E;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .real-time-badge {
            background: linear-gradient(45deg, #22C55E, #16A34A);
            color: #000;
            padding: 0.4rem 1rem;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 700;
            animation: glow 3s ease-in-out infinite alternate;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        @keyframes glow {
            from { box-shadow: 0 0 10px #22C55E; }
            to { box-shadow: 0 0 25px #22C55E, 0 0 35px #22C55E; }
        }

        .market-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(34, 197, 94, 0.2);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid rgba(34, 197, 94, 0.4);
        }

        .sharia-badge {
            background: rgba(34, 197, 94, 0.2);
            color: #22C55E;
            padding: 0.2rem 0.6rem;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid rgba(34, 197, 94, 0.4);
        }

        .mixed-badge {
            background: rgba(251, 191, 36, 0.2);
            color: #F59E0B;
            border: 1px solid rgba(251, 191, 36, 0.4);
        }

        @media (max-width: 1400px) {
            .main-container {
                grid-template-columns: 280px 1fr 300px;
            }
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
                height: auto;
            }
            
            .indices-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .status-bar {
                flex-wrap: wrap;
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .main-container {
                padding: 1rem;
                gap: 1rem;
            }

            .chart-controls {
                gap: 0.5rem;
            }

            .control-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }

            .sidebar, .market-info, .chart-container {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">
            ğŸ“Š Ù…Ù†ØµØ© Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
            <span class="real-time-badge">Ù…Ø¨Ø§Ø´Ø±</span>
        </div>

    <!-- Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ -->
    <button class="profit-calculator-btn" onclick="openCalculator()">
        ğŸ’° Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
    </button>

    <!-- Ù†Ø§ÙØ°Ø© Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ -->
    <div class="calculator-modal" id="calculatorModal">
        <div class="calculator-content">
            <div class="calculator-header">
                <h3 class="calculator-title">ğŸ’° Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</h3>
                <button class="close-btn" onclick="closeCalculator()">âœ•</button>
            </div>
            
            <form class="calc-form" onsubmit="calculateProfit(event)">
                <div class="calc-input-group">
                    <label class="calc-label">Ø§Ø³Ù… Ø§Ù„Ø³Ù‡Ù…</label>
                    <select class="calc-input" id="stockSelect">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³Ù‡Ù…</option>
                        <option value="aramco">Ø£Ø±Ø§Ù…ÙƒÙˆ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
                        <option value="rajhi">Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ</option>
                        <option value="sabic">Ø³Ø§Ø¨Ùƒ</option>
                        <option value="stc">Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
                        <option value="flynas">Ø·ÙŠØ±Ø§Ù† Ù†Ø§Ø³</option>
                        <option value="almarai">Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ</option>
                        <option value="ahli">Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ</option>
                        <option value="maaden">Ù…Ø¹Ø§Ø¯Ù†</option>
                    </select>
                </div>

                <div class="calc-input-group">
                    <label class="calc-label">Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡ (Ø±ÙŠØ§Ù„)</label>
                    <input type="number" class="calc-input" id="buyPrice" step="0.01" required>
                </div>

                <div class="calc-input-group">
                    <label class="calc-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ù‡Ù…</label>
                    <input type="number" class="calc-input" id="quantity" required>
                </div>

                <div class="calc-input-group">
                    <label class="calc-label">Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø±ÙŠØ§Ù„)</label>
                    <input type="number" class="calc-input" id="currentPrice" step="0.01" required>
                </div>

                <button type="submit" class="calc-button">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­</button>
                
                <button type="button" class="history-btn" onclick="showCalculationHistory()">
                    ğŸ“Š Ø¹Ø±Ø¶ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
                </button>
            </form>

            <div class="calc-results" id="calcResults" style="display: none;">
                <div class="calc-result-item">
                    <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±:</span>
                    <span id="totalInvestment">0 Ø±ÙŠØ§Ù„</span>
                </div>
                <div class="calc-result-item">
                    <span>Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</span>
                    <span id="currentValue">0 Ø±ÙŠØ§Ù„</span>
                </div>
                <div class="calc-result-item">
                    <span>Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©:</span>
                    <span id="profitLoss">0 Ø±ÙŠØ§Ù„</span>
                </div>
                <div class="calc-result-item">
                    <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©:</span>
                    <span id="profitPercentage">0%</span>
                </div>
            </div>
        </div>
    </div>
        <div class="status-bar">
            <div class="status-item">
                <div class="status-dot"></div>
                Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©
            </div>
            <div class="status-item">
                â° <span id="current-time"></span>
            </div>
            <div class="status-item">
                <span class="market-status">ğŸŸ¢ Ø§Ù„Ø³ÙˆÙ‚ Ù…ÙØªÙˆØ­</span>
            </div>
        </div>
    </header>

    <div class="main-container">
        <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
        <div class="sidebar">
            <div class="section-title">ğŸ“ˆ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            <div class="indices-grid">
                <div class="index-card">
                    <div class="index-name">Ù…Ø¤Ø´Ø± ØªØ§Ø³ÙŠ</div>
                    <div class="index-value" id="tasi-value">10,847.25</div>
                    <div class="index-change positive" id="tasi-change">+1.25%</div>
                </div>
                <div class="index-card">
                    <div class="index-name">Ù†Ù…Ùˆ</div>
                    <div class="index-value" id="nomu-value">26,672.18</div>
                    <div class="index-change positive" id="nomu-change">+0.81%</div>
                </div>
                <div class="index-card">
                    <div class="index-name">Ø¥Ù… ØªÙŠ 30</div>
                    <div class="index-value" id="mt30-value">1,394.76</div>
                    <div class="index-change positive" id="mt30-change">+1.18%</div>
                </div>
                <div class="index-card">
                    <div class="index-name">Ø§Ù„ØµÙƒÙˆÙƒ</div>
                    <div class="index-value" id="sukuk-value">913.82</div>
                    <div class="index-change positive" id="sukuk-change">+0.26%</div>
                </div>
            </div>

            <div class="section-title">ğŸ† Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ø£ÙƒØ«Ø± Ù†Ø´Ø§Ø·Ø§Ù‹</div>
            <div id="active-stocks">
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø£Ø±Ø§Ù…ÙƒÙˆ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
                        <div class="stock-sector">Ø·Ø§Ù‚Ø©</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">32.85</div>
                        <div class="index-change positive">+1.23%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ</div>
                        <div class="stock-sector">Ù…ØµØ§Ø±Ù</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">88.75</div>
                        <div class="index-change positive">+1.78%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø³Ø§Ø¨Ùƒ</div>
                        <div class="stock-sector">Ø¨ØªØ±ÙˆÙƒÙŠÙ…Ø§ÙˆÙŠØ§Øª</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">96.40</div>
                        <div class="index-change positive">+1.90%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
                        <div class="stock-sector">Ø§ØªØµØ§Ù„Ø§Øª</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">50.25</div>
                        <div class="index-change positive">+0.80%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø·ÙŠØ±Ø§Ù† Ù†Ø§Ø³</div>
                        <div class="stock-sector">Ù†Ù‚Ù„</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">83.60</div>
                        <div class="index-change positive">+4.50%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ</div>
                        <div class="stock-sector">Ù…ØµØ§Ø±Ù</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">34.90</div>
                        <div class="index-change positive">+2.35%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ù…Ø¹Ø§Ø¯Ù†</div>
                        <div class="stock-sector">ØªØ¹Ø¯ÙŠÙ†</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">47.80</div>
                        <div class="index-change negative">-0.62%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ</div>
                        <div class="stock-sector">Ø£ØºØ°ÙŠØ©</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">55.25</div>
                        <div class="index-change positive">+3.15%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <div class="main-chart-area">
            <div class="chart-container">
                <div class="chart-type-selector">
                    <button class="chart-type-btn active" onclick="changeChartType('line')">ğŸ“ˆ Ø®Ø·ÙŠ</button>
                    <button class="chart-type-btn" onclick="changeChartType('candlestick')">ğŸ•¯ï¸ Ø´Ù…ÙˆØ¹</button>
                </div>
                <div class="chart-controls">
                    <button class="control-btn active" onclick="changeTimeframe('1D')">ÙŠÙˆÙ…</button>
                    <button class="control-btn" onclick="changeTimeframe('1W')">Ø£Ø³Ø¨ÙˆØ¹</button>
                    <button class="control-btn" onclick="changeTimeframe('1M')">Ø´Ù‡Ø±</button>
                    <button class="control-btn" onclick="changeTimeframe('3M')">3 Ø£Ø´Ù‡Ø±</button>
                    <button class="control-btn" onclick="changeTimeframe('1Y')">Ø³Ù†Ø©</button>
                </div>
                <canvas id="mainChart"></canvas>
                <canvas id="candlestickChart" style="display: none;"></canvas>
                <div class="loading-indicator" id="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙˆÙ‚ -->
        <div class="market-info">
            <div class="section-title">ğŸ“° Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø³ÙˆÙ‚</div>
            <div id="market-news">
                <div class="news-item">
                    <div class="news-title">ğŸ“ˆ ØªØ§Ø³ÙŠ ÙŠØ­Ù‚Ù‚ Ù…ÙƒØ§Ø³Ø¨ Ù‚ÙˆÙŠØ© Ø¨Ù†Ø³Ø¨Ø© 1.25%</div>
                    <div class="news-summary">Ø§Ø±ØªÙØ¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ (ØªØ§Ø³ÙŠ) Ø¨Ù†Ø³Ø¨Ø© 1.25% Ù„ÙŠØµÙ„ Ø¥Ù„Ù‰ 10,847 Ù†Ù‚Ø·Ø©ØŒ Ù…Ø¯Ø¹ÙˆÙ…Ø§Ù‹ Ø¨ØµØ¹ÙˆØ¯ Ù‚Ø·Ø§Ø¹ÙŠ Ø§Ù„Ø·Ø§Ù‚Ø© ÙˆØ§Ù„Ù…ØµØ§Ø±Ù.</div>
                    <div class="news-time">â° Ù…Ù†Ø° 15 Ø¯Ù‚ÙŠÙ‚Ø©</div>
                </div>
                <div class="news-item">
                    <div class="news-title">âœˆï¸ Ø·ÙŠØ±Ø§Ù† Ù†Ø§Ø³ ÙŠØ­Ù„Ù‚ Ø¨Ù…ÙƒØ§Ø³Ø¨ 4.5% ÙÙŠ Ø«Ø§Ù†ÙŠ Ø¬Ù„Ø³Ø©</div>
                    <div class="news-summary">ÙˆØ§ØµÙ„Øª Ø£Ø³Ù‡Ù… Ø´Ø±ÙƒØ© Ø·ÙŠØ±Ø§Ù† Ù†Ø§Ø³ ØªØ­Ù‚ÙŠÙ‚ Ù…ÙƒØ§Ø³Ø¨ Ù‚ÙˆÙŠØ© Ù„Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ù„ÙŠ Ø¨Ù†Ø³Ø¨Ø© 4.5% Ù„ØªØµÙ„ Ø¥Ù„Ù‰ 83.60 Ø±ÙŠØ§Ù„ Ù„Ù„Ø³Ù‡Ù….</div>
                    <div class="news-time">â° Ù…Ù†Ø° 35 Ø¯Ù‚ÙŠÙ‚Ø©</div>
                </div>
                <div class="news-item">
                    <div class="news-title">ğŸ¦ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ ÙŠØ±ØªÙØ¹ 1.78% Ø¨Ø¹Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©</div>
                    <div class="news-summary">Ø­Ù‚Ù‚ Ø³Ù‡Ù… Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ Ù…ÙƒØ§Ø³Ø¨ Ø¨Ù†Ø³Ø¨Ø© 1.78% Ù„ÙŠØµÙ„ Ø¥Ù„Ù‰ 88.75 Ø±ÙŠØ§Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù† Ù†ØªØ§Ø¦Ø¬ Ø±Ø¨Ø¹ÙŠØ© Ù‚ÙˆÙŠØ©.</div>
                    <div class="news-time">â° Ù…Ù†Ø° Ø³Ø§Ø¹Ø©</div>
                </div>
                <div class="news-item">
                    <div class="news-title">âš¡ Ø£Ø±Ø§Ù…ÙƒÙˆ ØªØ¹Ù„Ù† Ø¹Ù† Ù…Ø´Ø±ÙˆØ¹ Ø·Ø§Ù‚Ø© Ù…ØªØ¬Ø¯Ø¯Ø© Ø¨Ù€3 Ù…Ù„ÙŠØ§Ø±Ø§Øª Ø±ÙŠØ§Ù„</div>
                    <div class="news-summary">Ø£Ø¹Ù„Ù†Øª Ø´Ø±ÙƒØ© Ø£Ø±Ø§Ù…ÙƒÙˆ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø¹Ù† Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø© Ø¨Ù‚ÙŠÙ…Ø© 3 Ù…Ù„ÙŠØ§Ø±Ø§Øª Ø±ÙŠØ§Ù„ØŒ Ù…Ù…Ø§ Ø¯ÙØ¹ Ø§Ù„Ø³Ù‡Ù… Ù„Ù„Ø§Ø±ØªÙØ§Ø¹.</div>
                    <div class="news-time">â° Ù…Ù†Ø° Ø³Ø§Ø¹ØªÙŠÙ†</div>
                </div>
                <div class="news-item">
                    <div class="news-title">ğŸ­ Ø³Ø§Ø¨Ùƒ ØªÙˆÙ‚Ø¹ Ø§ØªÙØ§Ù‚ÙŠØ© Ø´Ø±Ø§ÙƒØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©</div>
                    <div class="news-summary">ÙˆÙ‚Ø¹Øª Ø´Ø±ÙƒØ© Ø³Ø§Ø¨Ùƒ Ø§ØªÙØ§Ù‚ÙŠØ© Ø´Ø±Ø§ÙƒØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù…Ø¹ Ø´Ø±ÙƒØ© Ø¹Ø§Ù„Ù…ÙŠØ© Ù„ØªØ·ÙˆÙŠØ± Ù…Ù†ØªØ¬Ø§Øª Ø¨ØªØ±ÙˆÙƒÙŠÙ…Ø§ÙˆÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø©.</div>
                    <div class="news-time">â° Ù…Ù†Ø° 3 Ø³Ø§Ø¹Ø§Øª</div>
                </div>
                <div class="news-item">
                    <div class="news-title">ğŸ’° Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ ØªØ³ØªÙƒÙ…Ù„ Ø§Ø³ØªØ­ÙˆØ§Ø°Ù‡Ø§ Ø¹Ù„Ù‰ Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª</div>
                    <div class="news-summary">Ø£ØªÙ…Øª Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ Ø¨Ù†Ø¬Ø§Ø­ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø³ØªØ­ÙˆØ§Ø° Ø¹Ù„Ù‰ Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø§Ù„Ù†Ù‚ÙŠØ© Ø¨Ù‚ÙŠÙ…Ø© 1.04 Ù…Ù„ÙŠØ§Ø± Ø±ÙŠØ§Ù„ØŒ Ù…Ù…Ø§ Ø¹Ø²Ø² Ù…Ù† ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù†Ù…Ùˆ.</div>
                    <div class="news-time">â° Ù…Ù†Ø° 4 Ø³Ø§Ø¹Ø§Øª</div>
                </div>
            </div>

            <div class="section-title" style="margin-top: 2rem;">â˜ªï¸ Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ø´Ø±Ø¹ÙŠØ©</div>
            <div id="sharia-stocks">
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ</div>
                        <div class="stock-sector sharia-badge">âœ… Ù†Ù‚ÙŠ</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">88.75</div>
                        <div class="index-change positive">+1.78%</div>
                    </div>
                </div>
                <div class="stock-item">
                    <div class="stock-info">
                        <div class="stock-name">Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</div>
                        <div class="stock-sector sharia-badge">âœ… Ù†Ù‚ÙŠ</div>
                    </div>
                    <div class="stock-price">
                        <div class="price">32.85</div>
                        <div class="index-change positive">+1.23%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…ØªØ­Ø±Ùƒ -->
    <div class="ticker-tape">
        <div class="ticker-content" id="ticker">
            ğŸ”¥ Ø¹Ø§Ø¬Ù„: ØªØ§Ø³ÙŠ ÙŠØ±ØªÙØ¹ 1.25% Ø¥Ù„Ù‰ 10,847 Ù†Ù‚Ø·Ø© â€¢ Ø·ÙŠØ±Ø§Ù† Ù†Ø§Ø³ ÙŠØ­Ù„Ù‚ Ø¨Ù…ÙƒØ§Ø³Ø¨ 4.5% â€¢ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ ÙŠØ­Ù‚Ù‚ Ø£Ø±Ø¨Ø§Ø­Ø§Ù‹ Ù‚ÙˆÙŠØ© +1.78% â€¢ Ø£Ø±Ø§Ù…ÙƒÙˆ ØªØ³ØªØ«Ù…Ø± 3 Ù…Ù„ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ¬Ø¯Ø¯Ø© â€¢ Ø³Ø§Ø¨Ùƒ ØªÙˆÙ‚Ø¹ Ø´Ø±Ø§ÙƒØ© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© â€¢ Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ ØªØ³ØªÙƒÙ…Ù„ Ø§Ù„Ø§Ø³ØªØ­ÙˆØ§Ø° Ø¨Ù†Ø¬Ø§Ø­ â€¢ Ø§Ù„Ù†ÙØ· ÙŠØ±ØªÙØ¹ Ø¥Ù„Ù‰ 67.2 Ø¯ÙˆÙ„Ø§Ø± Ù„Ù„Ø¨Ø±Ù…ÙŠÙ„
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (Ù…Ø­Ø§ÙƒØ§Ø© Ù„Ø£Ø³Ø¹Ø§Ø± Ø­Ù‚ÙŠÙ‚ÙŠØ©)
        const stockData = {
            'aramco': { price: 32.85, change: 1.23, volume: 15420000 },
            'rajhi': { price: 88.75, change: 1.78, volume: 8950000 },
            'sabic': { price: 96.40, change: 1.90, volume: 6780000 },
            'stc': { price: 50.25, change: 0.80, volume: 4520000 },
            'flynas': { price: 83.60, change: 4.50, volume: 12340000 },
            'ahli': { price: 34.90, change: 2.35, volume: 7890000 },
            'maaden': { price: 47.80, change: -0.62, volume: 3450000 },
            'almarai': { price: 55.25, change: 3.15, volume: 2980000 }
        };

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
        const indexData = {
            'tasi': { value: 10847.25, change: 1.25 },
            'nomu': { value: 26672.18, change: 0.81 },
            'mt30': { value: 1394.76, change: 1.18 },
            'sukuk': { value: 913.82, change: 0.26 }
        };

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ
        function updateTime() {
            const now = new Date();
            const options = {
                timeZone: 'Asia/Riyadh',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            const timeString = now.toLocaleTimeString('ar-SA', options);
            document.getElementById('current-time').textContent = timeString;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
        function updateLiveData() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
            Object.keys(indexData).forEach(index => {
                const valueElement = document.getElementById(index + '-value');
                const changeElement = document.getElementById(index + '-change');
                
                if (valueElement && changeElement) {
                    // Ù…Ø­Ø§ÙƒØ§Ø© ØªØºÙŠÙŠØ± Ø·ÙÙŠÙ ÙÙŠ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Â±0.5%)
                    const change = (Math.random() - 0.5) * 0.01;
                    indexData[index].value *= (1 + change);
                    indexData[index].change += (change * 100);
                    
                    valueElement.textContent = indexData[index].value.toLocaleString('ar-SA', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                    
                    const changePercent = indexData[index].change.toFixed(2);
                    changeElement.textContent = (indexData[index].change >= 0 ? '+' : '') + changePercent + '%';
                    changeElement.className = 'index-change ' + (indexData[index].change >= 0 ? 'positive' : 'negative');
                }
            });

            // ØªØ­Ø¯ÙŠØ« Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø£Ø³Ù‡Ù…
            Object.keys(stockData).forEach(stock => {
                const change = (Math.random() - 0.5) * 0.008; // ØªØºÙŠÙŠØ± Ø£ØµØºØ± Ù„Ù„Ø£Ø³Ù‡Ù…
                stockData[stock].price *= (1 + change);
                stockData[stock].change += (change * 100);
            });

            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ù†Ø´Ø·Ø©
            updateActiveStocks();
        }

        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ù†Ø´Ø·Ø©
        function updateActiveStocks() {
            const activeStocksContainer = document.getElementById('active-stocks');
            const stocks = [
                { name: 'Ø£Ø±Ø§Ù…ÙƒÙˆ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', sector: 'Ø·Ø§Ù‚Ø©', key: 'aramco' },
                { name: 'Ù…ØµØ±Ù Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ', sector: 'Ù…ØµØ§Ø±Ù', key: 'rajhi' },
                { name: 'Ø³Ø§Ø¨Ùƒ', sector: 'Ø¨ØªØ±ÙˆÙƒÙŠÙ…Ø§ÙˆÙŠØ§Øª', key: 'sabic' },
                { name: 'Ø§Ù„Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', sector: 'Ø§ØªØµØ§Ù„Ø§Øª', key: 'stc' },
                { name: 'Ø·ÙŠØ±Ø§Ù† Ù†Ø§Ø³', sector: 'Ù†Ù‚Ù„', key: 'flynas' },
                { name: 'Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ', sector: 'Ù…ØµØ§Ø±Ù', key: 'ahli' },
                { name: 'Ù…Ø¹Ø§Ø¯Ù†', sector: 'ØªØ¹Ø¯ÙŠÙ†', key: 'maaden' },
                { name: 'Ø§Ù„Ù…Ø±Ø§Ø¹ÙŠ', sector: 'Ø£ØºØ°ÙŠØ©', key: 'almarai' }
            ];

            const stocksHTML = stocks.map(stock => {
                const data = stockData[stock.key];
                const changeClass = data.change >= 0 ? 'positive' : 'negative';
                const changeSign = data.change >= 0 ? '+' : '';
                
                return `
                    <div class="stock-item">
                        <div class="stock-info">
                            <div class="stock-name">${stock.name}</div>
                            <div class="stock-sector">${stock.sector}</div>
                        </div>
                        <div class="stock-price">
                            <div class="price">${data.price.toFixed(2)}</div>
                            <div class="index-change ${changeClass}">${changeSign}${data.change.toFixed(2)}%</div>
                        </div>
                    </div>
                `;
            }).join('');

            activeStocksContainer.innerHTML = stocksHTML;
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ Ø§Ù„Ù…Ø­Ø³Ù†
        let mainChart;
        let candlestickChart;
        let currentChartType = 'line';

        function createChart() {
            createLineChart();
            createCandlestickChart();
        }

        function createLineChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            
            // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ø±ÙŠØ®ÙŠØ© Ù„Ù…Ø¤Ø´Ø± ØªØ§Ø³ÙŠ
            const labels = [];
            const data = [];
            const baseValue = 10847;
            const now = new Date();
            
            // Ø¥Ù†Ø´Ø§Ø¡ 100 Ù†Ù‚Ø·Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
            for (let i = 99; i >= 0; i--) {
                const date = new Date(now.getTime() - (i * 5 * 60 * 1000)); // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
                labels.push(date.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' }));
                
                // Ù…Ø­Ø§ÙƒØ§Ø© ØªÙ‚Ù„Ø¨Ø§Øª Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
                const trend = Math.sin(i / 20) * 50; // Ø§ØªØ¬Ø§Ù‡ Ø¹Ø§Ù…
                const noise = (Math.random() - 0.5) * 80; // ØªÙ‚Ù„Ø¨Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                data.push(baseValue + trend + noise);
            }

            // Ø¥Ù†Ø´Ø§Ø¡ ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ Ù„Ù„Ù…Ù†Ø·Ù‚Ø© ØªØ­Øª Ø§Ù„Ø®Ø·
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(34, 197, 94, 0.3)');
            gradient.addColorStop(0.5, 'rgba(34, 197, 94, 0.15)');
            gradient.addColorStop(1, 'rgba(34, 197, 94, 0.02)');

            mainChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Ù…Ø¤Ø´Ø± ØªØ§Ø³ÙŠ',
                        data: data,
                        borderColor: '#22C55E',
                        backgroundColor: gradient,
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 8,
                        pointHoverBackgroundColor: '#22C55E',
                        pointHoverBorderColor: '#ffffff',
                        pointHoverBorderWidth: 3,
                        shadowColor: 'rgba(34, 197, 94, 0.5)',
                        shadowBlur: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#22C55E',
                            bodyColor: '#ffffff',
                            borderColor: '#22C55E',
                            borderWidth: 1,
                            cornerRadius: 10,
                            displayColors: false,
                            callbacks: {
                                title: function(context) {
                                    return 'Ø§Ù„ÙˆÙ‚Øª: ' + context[0].label;
                                },
                                label: function(context) {
                                    return 'ØªØ§Ø³ÙŠ: ' + context.parsed.y.toLocaleString('ar-SA', {
                                        minimumFractionDigits: 2,
                                        maximumFractionDigits: 2
                                    });
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                maxTicksLimit: 8,
                                font: {
                                    size: 11
                                }
                            }
                        },
                        y: {
                            display: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value.toLocaleString('ar-SA');
                                },
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    },
                    elements: {
                        line: {
                            borderJoinStyle: 'round'
                        }
                    }
                }
            });
        }

        function createCandlestickChart() {
            const ctx = document.getElementById('candlestickChart').getContext('2d');
            
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù…ÙˆØ¹ Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠØ©
            const candleData = generateCandlestickData();
            
            candlestickChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: candleData.labels,
                    datasets: [
                        {
                            label: 'Ø£Ø¹Ù„Ù‰ Ø³Ø¹Ø±',
                            data: candleData.high,
                            backgroundColor: 'transparent',
                            borderColor: '#22C55E',
                            borderWidth: 1,
                            barThickness: 1,
                            categoryPercentage: 1.0,
                            barPercentage: 1.0
                        },
                        {
                            label: 'Ø£Ø¯Ù†Ù‰ Ø³Ø¹Ø±', 
                            data: candleData.low,
                            backgroundColor: 'transparent',
                            borderColor: '#EF4444',
                            borderWidth: 1,
                            barThickness: 1,
                            categoryPercentage: 1.0,
                            barPercentage: 1.0
                        },
                        {
                            label: 'Ø§Ù„Ø¥ØºÙ„Ø§Ù‚',
                            data: candleData.close.map((close, i) => {
                                return {
                                    x: i,
                                    y: close,
                                    open: candleData.open[i],
                                    close: close,
                                    color: close >= candleData.open[i] ? '#22C55E' : '#EF4444'
                                };
                            }),
                            backgroundColor: function(context) {
                                const point = context.parsed;
                                return point.close >= candleData.open[context.dataIndex] ? 
                                    'rgba(34, 197, 94, 0.8)' : 'rgba(239, 68, 68, 0.8)';
                            },
                            borderColor: function(context) {
                                const point = context.parsed;
                                return point.close >= candleData.open[context.dataIndex] ? 
                                    '#22C55E' : '#EF4444';
                            },
                            borderWidth: 2,
                            barThickness: 8
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#22C55E',
                            bodyColor: '#ffffff',
                            borderColor: '#22C55E',
                            borderWidth: 1,
                            cornerRadius: 10,
                            callbacks: {
                                title: function(context) {
                                    return 'Ø§Ù„ÙˆÙ‚Øª: ' + context[0].label;
                                },
                                label: function(context) {
                                    const dataIndex = context.dataIndex;
                                    return [
                                        `Ø§Ù„Ø§ÙØªØªØ§Ø­: ${candleData.open[dataIndex].toFixed(2)}`,
                                        `Ø§Ù„Ø¥ØºÙ„Ø§Ù‚: ${candleData.close[dataIndex].toFixed(2)}`,
                                        `Ø§Ù„Ø£Ø¹Ù„Ù‰: ${candleData.high[dataIndex].toFixed(2)}`,
                                        `Ø§Ù„Ø£Ø¯Ù†Ù‰: ${candleData.low[dataIndex].toFixed(2)}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                maxTicksLimit: 8
                            }
                        },
                        y: {
                            display: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)',
                                drawBorder: false
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value.toLocaleString('ar-SA');
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        function generateCandlestickData() {
            const data = {
                labels: [],
                open: [],
                high: [],
                low: [],
                close: []
            };

            let basePrice = 10847;
            const now = new Date();

            for (let i = 50; i >= 0; i--) {
                const date = new Date(now.getTime() - (i * 15 * 60 * 1000)); // ÙƒÙ„ 15 Ø¯Ù‚ÙŠÙ‚Ø©
                data.labels.push(date.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' }));

                // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù…ÙˆØ¹
                const openPrice = basePrice + (Math.random() - 0.5) * 20;
                const volatility = 10 + Math.random() * 15;
                const high = openPrice + Math.random() * volatility;
                const low = openPrice - Math.random() * volatility;
                const closePrice = low + Math.random() * (high - low);

                data.open.push(openPrice);
                data.high.push(high);
                data.low.push(low);
                data.close.push(closePrice);

                basePrice = closePrice; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø³Ø¹Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ ÙƒØ£Ø³Ø§Ø³ Ù„Ù„Ø´Ù…Ø¹Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
            }

            return data;
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
        function changeChartType(type) {
            document.querySelectorAll('.chart-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            currentChartType = type;
            
            if (type === 'line') {
                document.getElementById('mainChart').style.display = 'block';
                document.getElementById('candlestickChart').style.display = 'none';
            } else {
                document.getElementById('mainChart').style.display = 'none';
                document.getElementById('candlestickChart').style.display = 'block';
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ù… Ø§Ù„Ø´Ù…ÙˆØ¹ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
                if (candlestickChart) {
                    candlestickChart.destroy();
                }
                createCandlestickChart();
            }
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø²Ù…Ù†ÙŠ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª
        function changeTimeframe(timeframe) {
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø£Ù†ÙŠÙ‚
            const loading = document.getElementById('loading');
            loading.style.display = 'block';
            
            setTimeout(() => {
                updateChartData(timeframe);
                loading.style.display = 'none';
            }, 1200);
        }

        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
        function updateChartData(timeframe) {
            const config = {
                '1D': { points: 100, interval: 5, baseValue: 10847 },
                '1W': { points: 80, interval: 30, baseValue: 10800 },
                '1M': { points: 60, interval: 120, baseValue: 10750 },
                '3M': { points: 45, interval: 480, baseValue: 10600 },
                '1Y': { points: 50, interval: 2880, baseValue: 10200 }
            };
            
            const { points, interval, baseValue } = config[timeframe];
            
            if (currentChartType === 'line' && mainChart) {
                const newData = [];
                const newLabels = [];
                const now = new Date();
                
                for (let i = points - 1; i >= 0; i--) {
                    const date = new Date(now.getTime() - (i * interval * 60 * 1000));
                    
                    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø²Ù…Ù†ÙŠ
                    let label;
                    if (timeframe === '1D') {
                        label = date.toLocaleTimeString('ar-SA', { hour: '2-digit', minute: '2-digit' });
                    } else if (timeframe === '1W') {
                        label = date.toLocaleDateString('ar-SA', { weekday: 'short' });
                    } else {
                        label = date.toLocaleDateString('ar-SA', { month: 'short', day: 'numeric' });
                    }
                    
                    newLabels.push(label);
                    
                    // Ù…Ø­Ø§ÙƒØ§Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø²Ù…Ù†ÙŠ
                    const trend = Math.sin(i / (points / 4)) * (baseValue * 0.05);
                    const seasonality = Math.sin(i / (points / 12)) * (baseValue * 0.02);
                    const noise = (Math.random() - 0.5) * (baseValue * 0.03);
                    
                    newData.push(baseValue + trend + seasonality + noise);
                }
                
                mainChart.data.datasets[0].data = newData;
                mainChart.data.labels = newLabels;
                mainChart.update('active');
            } else if (currentChartType === 'candlestick' && candlestickChart) {
                // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù…ÙˆØ¹
                candlestickChart.destroy();
                createCandlestickChart();
            }
        }

        // ÙØªØ­ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
        function openCalculator() {
            document.getElementById('calculatorModal').style.display = 'flex';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            const stockSelect = document.getElementById('stockSelect');
            const currentPriceInput = document.getElementById('currentPrice');
            
            stockSelect.addEventListener('change', function() {
                const selectedStock = this.value;
                if (selectedStock && stockData[selectedStock]) {
                    currentPriceInput.value = stockData[selectedStock].price.toFixed(2);
                }
            });
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
        function closeCalculator() {
            document.getElementById('calculatorModal').style.display = 'none';
            document.getElementById('calcResults').style.display = 'none';
            document.querySelector('.calc-form').reset();
        }

        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±
        function calculateProfit(event) {
            event.preventDefault();
            
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            const currentPrice = parseFloat(document.getElementById('currentPrice').value);
            
            if (!buyPrice || !quantity || !currentPrice) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„');
                return;
            }
            
            // Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
            const totalInvestment = buyPrice * quantity;
            const currentValue = currentPrice * quantity;
            const profitLoss = currentValue - totalInvestment;
            const profitPercentage = ((profitLoss / totalInvestment) * 100);
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            document.getElementById('totalInvestment').textContent = 
                totalInvestment.toLocaleString('ar-SA', { minimumFractionDigits: 2 }) + ' Ø±ÙŠØ§Ù„';
            
            document.getElementById('currentValue').textContent = 
                currentValue.toLocaleString('ar-SA', { minimumFractionDigits: 2 }) + ' Ø±ÙŠØ§Ù„';
            
            const profitLossElement = document.getElementById('profitLoss');
            const profitPercentageElement = document.getElementById('profitPercentage');
            
            profitLossElement.textContent = 
                (profitLoss >= 0 ? '+' : '') + profitLoss.toLocaleString('ar-SA', { minimumFractionDigits: 2 }) + ' Ø±ÙŠØ§Ù„';
            
            profitPercentageElement.textContent = 
                (profitPercentage >= 0 ? '+' : '') + profitPercentage.toFixed(2) + '%';
            
            // ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            const color = profitLoss >= 0 ? '#22C55E' : '#EF4444';
            profitLossElement.style.color = color;
            profitPercentageElement.style.color = color;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø§Ù†ÙŠÙ…ÙŠØ´Ù†
            const resultsDiv = document.getElementById('calcResults');
            resultsDiv.style.display = 'block';
            resultsDiv.style.opacity = '0';
            resultsDiv.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                resultsDiv.style.transition = 'all 0.5s ease';
                resultsDiv.style.opacity = '1';
                resultsDiv.style.transform = 'translateY(0)';
            }, 100);
            
            // Ø­ÙØ¸ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ù…Ø­Ø§ÙƒØ§Ø©)
            saveCalculationHistory({
                stock: document.getElementById('stockSelect').value,
                buyPrice,
                quantity,
                currentPrice,
                profitLoss,
                profitPercentage,
                date: new Date().toLocaleString('ar-SA')
            });
        }

        // Ø­ÙØ¸ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
        function saveCalculationHistory(calculation) {
            let history = JSON.parse(localStorage.getItem('calculationHistory') || '[]');
            history.unshift(calculation);
            
            // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¢Ø®Ø± 10 Ø­Ø³Ø§Ø¨Ø§Øª ÙÙ‚Ø·
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            localStorage.setItem('calculationHistory', JSON.stringify(history));
        }

        // Ø¹Ø±Ø¶ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª
        function showCalculationHistory() {
            const history = JSON.parse(localStorage.getItem('calculationHistory') || '[]');
            
            if (history.length === 0) {
                alert('Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ§Ø±ÙŠØ® Ø­Ø³Ø§Ø¨Ø§Øª Ø¨Ø¹Ø¯');
                return;
            }
            
            let historyHTML = '<h4 style="color: #22C55E; margin-bottom: 1rem;">ğŸ“Š ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª</h4>';
            
            history.forEach((calc, index) => {
                const profitColor = calc.profitLoss >= 0 ? '#22C55E' : '#EF4444';
                historyHTML += `
                    <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 10px; margin-bottom: 0.5rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <strong>${calc.stock || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</strong>
                            <span style="font-size: 0.8rem; opacity: 0.7;">${calc.date}</span>
                        </div>
                        <div style="font-size: 0.9rem;">
                            Ø§Ù„ÙƒÙ…ÙŠØ©: ${calc.quantity} Ø³Ù‡Ù… | Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡: ${calc.buyPrice.toFixed(2)} Ø±ÙŠØ§Ù„
                        </div>
                        <div style="color: ${profitColor}; font-weight: bold;">
                            Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©: ${calc.profitLoss.toFixed(2)} Ø±ÙŠØ§Ù„ (${calc.profitPercentage.toFixed(2)}%)
                        </div>
                    </div>
                `;
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ®
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center;
                z-index: 1001; backdrop-filter: blur(10px);
            `;
            
            modal.innerHTML = `
                <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(20px); 
                           border-radius: 20px; padding: 2rem; max-width: 500px; width: 90%; 
                           max-height: 80vh; overflow-y: auto; border: 1px solid rgba(34,197,94,0.3);">
                    ${historyHTML}
                    <button onclick="this.closest('.modal').remove()" 
                            style="background: linear-gradient(135deg, #22C55E, #16A34A); border: none; 
                                   border-radius: 10px; padding: 0.8rem 1.5rem; color: white; 
                                   font-weight: bold; cursor: pointer; width: 100%; margin-top: 1rem;">
                        Ø¥ØºÙ„Ø§Ù‚
                    </button>
                </div>
            `;
            
            modal.className = 'modal';
            document.body.appendChild(modal);
        }

        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© Ù„Ù„Ø¹Ù†Ø§ØµØ±
        function addAnimations() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });

            document.querySelectorAll('.stock-item, .news-item, .index-card').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.6s ease';
                observer.observe(el);
            });
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
        function setupMobileInteractions() {
            let touchStartX = 0;
            let touchStartY = 0;

            document.addEventListener('touchstart', function(e) {
                touchStartX = e.touches[0].clientX;
                touchStartY = e.touches[0].clientY;
            }, { passive: true });

            document.addEventListener('touchmove', function(e) {
                if (!touchStartX || !touchStartY) return;
                
                let touchEndX = e.touches[0].clientX;
                let touchEndY = e.touches[0].clientY;
                
                let diffX = touchStartX - touchEndX;
                let diffY = touchStartY - touchEndY;
                
                // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø£ÙÙ‚ÙŠ ØºÙŠØ± Ø§Ù„Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡
                if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                    e.preventDefault();
                }
            }, { passive: false });
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            // ØªÙ‡ÙŠØ¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
            updateTime();
            createChart();
            updateActiveStocks();
            addAnimations();
            setupMobileInteractions();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
            setInterval(updateTime, 1000);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 3 Ø«ÙˆØ§Ù†ÙŠ Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
            setInterval(updateLiveData, 3000);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ ÙƒÙ„ 15 Ø«Ø§Ù†ÙŠØ©
            setInterval(() => {
                if (currentChartType === 'line' && mainChart) {
                    const activeBtn = document.querySelector('.control-btn.active');
                    if (activeBtn) {
                        const timeframe = activeBtn.textContent.includes('ÙŠÙˆÙ…') ? '1D' :
                                        activeBtn.textContent.includes('Ø£Ø³Ø¨ÙˆØ¹') ? '1W' :
                                        activeBtn.textContent.includes('Ø´Ù‡Ø±') && !activeBtn.textContent.includes('3') ? '1M' :
                                        activeBtn.textContent.includes('3') ? '3M' : '1Y';
                        updateChartData(timeframe);
                    }
                } else if (currentChartType === 'candlestick' && candlestickChart) {
                    // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ù…ÙˆØ¹
                    const newCandleData = generateCandlestickData();
                    candlestickChart.data.labels = newCandleData.labels;
                    candlestickChart.data.datasets[2].data = newCandleData.close.map((close, i) => {
                        return {
                            x: i,
                            y: close,
                            open: newCandleData.open[i],
                            close: close,
                            color: close >= newCandleData.open[i] ? '#22C55E' : '#EF4444'
                        };
                    });
                    candlestickChart.update('none');
                }
            }, 15000);

            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ù‚Ø± Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.control-btn, .chart-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });

            // Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeCalculator();
                }
                if (e.key === 'c' && e.ctrlKey) {
                    openCalculator();
                    e.preventDefault();
                }
            });

            // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
            document.querySelectorAll('.stock-item').forEach(item => {
                item.addEventListener('click', function() {
                    this.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
        });

        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª ØµÙˆØªÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©)
        function playClickSound() {
            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù ØµÙˆØªÙŠ Ù„Ù„Ù†Ù‚Ø±Ø§Øª
            // const audio = new Audio('click.mp3');
            // audio.play().catch(() => {});
        }

        // Ø­ÙØ¸ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function saveUserPreferences() {
            const activeTimeframe = document.querySelector('.control-btn.active')?.textContent;
            localStorage.setItem('preferredTimeframe', activeTimeframe);
        }

        // Ø§Ø³ØªØ±Ø¯Ø§Ø¯ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function loadUserPreferences() {
            const savedTimeframe = localStorage.getItem('preferredTimeframe');
            if (savedTimeframe) {
                document.querySelectorAll('.control-btn').forEach(btn => {
                    if (btn.textContent === savedTimeframe) {
                        btn.click();
                    }
                });
            }
        }
    </script>
</body>
</html>
